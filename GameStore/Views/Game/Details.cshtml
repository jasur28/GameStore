@model GameStore.ViewModel.CommentViewModel
@using GameStore.DAL.Entities
@using Microsoft.AspNetCore.Identity
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@{
	ViewData["Title"] = "Details";

}
@{
	var base64 = Convert.ToBase64String(@Model.Game.Photo);
	var imgSrc = String.Format("data:image/gif;base64,{0}", base64);
}
<!-- Page info section -->
<section class="page-info-section set-bg" data-setbg="@imgSrc">
	<div class="pi-content">
		<div class="container">
			<div class="row">
				<div class="col-xl-5 col-lg-6 text-white">
					<h2>@Model.Game.Name</h2>
					<p>@Model.Game.Description</p>
				</div>
			</div>
		</div>
	</div>
</section>
<!-- Page info section -->
<!-- Page section -->
<section class="page-section single-blog-page spad">
	<div class="container">
		<div class="row">
			<div class="col-lg-10">
				<div class="blog-thumb set-bg" data-setbg="@imgSrc">
				</div>
				<div class="blog-content">
					@foreach (var assignedGame in Model.Game.GameGenres)
					{
						<div class="col-lg-10">
							<h4>@assignedGame.Genre.Name</h4>
						</div>
					}
					<h3>@Model.Game.Name</h3>
					<p>@Model.Game.Description</p>
				</div>
				<!--Comment section-->
				<div class="comment-warp">
					<h4 class="comment-title">Comments</h4>
					<ul class="comment-list">
						
						@foreach (var comments in Model.Comment.Where(x=>x.ParentId ==null))
						{
						<li>
							<div class="comment">
									@if (comments.User.ProfilePicture != null)
									{
										<div class="comment-avator set-bg" data-setbg="data:image/*;base64,@(Convert.ToBase64String(comments.User.ProfilePicture))"></div>
									}
								<div class="comment-content">
									<h5>@comments.User.FirstName @comments.User.LastName<span>@comments.CommentDate</span></h5>
									<p>@comments.CommentText</p>
									<a href="" class="reply">Reply</a>
										<!-- For--> 
										@foreach(var replies in comments.Children)
										{
											<div class="comment-reply">
												<div class="comment">
														@if (comments.User.ProfilePicture != null)
														{
														<div class="comment-avator set-bg" data-setbg="data:image/*;base64,@(Convert.ToBase64String(replies.User.ProfilePicture))"></div>
														}
														<div class="comment-content">
															<h5>@replies.User.FirstName @replies.User.LastName<span>@replies.CommentDate</span></h5>
															<p>@replies.CommentText</p>
															<a href="" class="reply">Reply</a>
														</div>
												</div>
											</div>
										}
										<!-- For End Section-->
								</div>
							</div>
						</li>
						}
					</ul>
				</div>
				<div class="comment-form-warp">
					<h4 class="comment-title">Leave Your Comment</h4>
					<form method="post" asp-action="Details" asp-controller="Game" enctype="multipart/form-data">
						<input type="hidden" name="GameId" value="@Model.Game.Id" />
						<input type="hidden" name="PostType" value="comment" />
						<div class="row">
							<div class="col-lg-12">
								<textarea type="text" name="CommentText" placeholder="Leave Comment ..."
								style="width:100%; height:60px;"></textarea>
								<input type="submit" value="Send" class="site-btn btn-sm" />
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</section>

<script src="~/js/comments.js">
	
</script>

<!-- Page section end -->
@*@model GameStore.ViewModel.CommentViewModel
@using GameStore.DAL.Entities
@using Microsoft.AspNetCore.Identity
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@{
    ViewData["Title"] = "Details";
	
}
<div></div>
<section class="review-section spad">
<div class="container">
<div class="row justify-content-center">
		<div class="col-lg-3 col-md-6">
	<div class="review-item">
		@{
			var base64 = Convert.ToBase64String(@Model.Game.Photo);
			var imgSrc = String.Format("data:image/gif;base64,{0}", base64);
		 }
	
		<div class="review-cover set-bg" data-setbg="@imgSrc">
						<div class="score purple">@Model.Game.Price $</div>
		</div>

				@foreach (var assignedTeam in Model.Game.GameGenres)
				{
						<div class="row">
							<h4>@assignedTeam.Genre.Name</h4>
						</div>
				}
		
		<div class="review-text">
						<h5>@Model.Game.Name</h5>
						<p>@Model.Game.Description</p>
		</div>
				<div>
					<a asp-controller="Game" asp-action="Edit" asp-route-id="@Model.Game.Id"><input type="button" class="btn btn-warning" value="Edit Game" /></a>
						<a asp-controller="Game" asp-action="Delete" asp-route-id="@Model.Game.Id"><input type="button" class="btn btn-danger" value="Delete Game" /></a>
				</div>
	</div>
	</div>
		
</div>
</div>

</section>

<div>
	<a asp-controller="Home" asp-action="Index"><input type="button" class="btn btn-success" value="Back" /></a>
</div>*@